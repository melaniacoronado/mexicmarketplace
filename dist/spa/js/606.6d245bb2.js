"use strict";(self["webpackChunkmacodesgin"]=self["webpackChunkmacodesgin"]||[]).push([[606],{7606:(e,a,t)=>{t.r(a),t.d(a,{default:()=>x});var l=t(3673);const o=e=>((0,l.dD)("data-v-3d2f12f4"),e=e(),(0,l.Cn)(),e),n=o((()=>(0,l._)("h5",{class:"text-primary"},"Crear cuenta",-1))),r=o((()=>(0,l._)("div",{class:"linea bg-primary"},null,-1))),i={class:"botones"};function s(e,a,t,o,s,c){const d=(0,l.up)("q-input"),m=(0,l.up)("q-btn"),u=(0,l.up)("q-form"),p=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(p,{class:"flex flex-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{onSubmit:o.onSubmit,onReset:o.onClean,class:"login-form"},{default:(0,l.w5)((()=>[n,r,(0,l.Wm)(d,{filled:"",type:"text",modelValue:o.state.nombreCliente,"onUpdate:modelValue":a[0]||(a[0]=e=>o.state.nombreCliente=e),label:"Nombre",hint:"Ej. Juan",maxlength:"50","lazy-rules":"",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío",e=>e&&e.length<50||"El nombre debe tener menos de 50 caracteres"]},null,8,["modelValue","rules"]),(0,l.Wm)(d,{filled:"",type:"text",modelValue:o.state.apellidoCliente,"onUpdate:modelValue":a[1]||(a[1]=e=>o.state.apellidoCliente=e),label:"Apellidos",hint:"Ej. Pérez González",maxlength:"50","lazy-rules":"",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío",e=>e&&e.length<50||"Los apellidos deben tener menos de 50 caracteres"]},null,8,["modelValue","rules"]),(0,l.Wm)(d,{filled:"",type:"text",mask:"phone",modelValue:o.state.telefonoCliente,"onUpdate:modelValue":a[2]||(a[2]=e=>o.state.telefonoCliente=e),label:"Teléfono",hint:"Ej. (818) 323 - 8328","lazy-rules":"",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío",e=>e&&16==e.length||"El número de teléfono debe tener 10 dígitos"]},null,8,["modelValue","rules"]),(0,l.Wm)(d,{filled:"",type:"email",modelValue:o.state.emailCliente,"onUpdate:modelValue":a[3]||(a[3]=e=>o.state.emailCliente=e),label:"Correo",hint:"Ej. juan.perez@gmail.com",maxlength:"50","lazy-rules":"",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío",e=>e.includes("@")||"Por favor, escriba un correo válido",e=>e&&e.length<50||"El correo debe tener menos de 50 caracteres"]},null,8,["modelValue","rules"]),(0,l.Wm)(d,{filled:"",type:"date",modelValue:o.state.fechaNacimiento,"onUpdate:modelValue":a[4]||(a[4]=e=>o.state.fechaNacimiento=e),label:"Fecha de nacimiento",mask:"##/##/####","stack-label":"",hint:"Ej. 10/02/1999","lazy-rules":"",rules:[e=>e&&e.length>0||"Este campo no puede estar vacío",e=>e&&10==e.length||"La fecha debe tener el formato dd/mm/aaaa"]},null,8,["modelValue","rules"]),(0,l.Wm)(d,{filled:"",type:"password",modelValue:o.state.password,"onUpdate:modelValue":a[5]||(a[5]=e=>o.state.password=e),label:"Contraseña",hint:"La contraseña debe tener más de 8 caracteres, contener 1 letra mayúscula y 1 número",maxlength:"50","lazy-rules":"",rules:[e=>e&&e.length>7||"La contraseña debe tener al menos 8 caracteres",e=>e&&e.length<50||"La contraseña debe tener menos de 50 caracteres",e=>e&&-1!=e.search(/[A-Z]/)||"La contraseña debe tener una letra mayúscula",e=>e&&-1!=e.search(/[0-9]/)||"La contraseña debe tener un número"]},null,8,["modelValue","rules"]),(0,l._)("div",i,[(0,l.Wm)(m,{size:"1rem",class:"q-px-xl q-py-xs",color:"primary",label:"Crear cuenta",onClick:o.onSubmit},null,8,["onClick"]),(0,l.Wm)(m,{flat:"",size:"1rem",class:"q-px-xl q-py-xs",type:"reset",color:"primary",label:"LIMPIAR"})])])),_:1},8,["onSubmit","onReset"])])),_:1})}t(9544),t(5363);var c=t(1959),d=t(5474),m=t(8825),u=t(9582);const p={name:"CrearCuenta",setup(){document.title="Crear Cuenta";const e=(0,m.Z)(),a=((0,u.tv)(),(0,c.qj)({nombreCliente:"",apellidoCliente:"",telefonoCliente:"",emailCliente:"",fechaNacimiento:"",password:""}));function t(){nombreCliente="",apellidoCliente="",telefonoCliente="",emailCliente="",fechaNacimiento="",password=""}async function o(){if(""==a.nombreCliente||""==a.apellidoCliente||""==a.telefonoCliente||""==a.emailCliente||""==a.fechaNacimiento||""==a.password)return void e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Por favor, llena todos los campos."});if(a.password.length<8)return void e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Corrige los campos en rojo."});if(a.telefonoCliente.length<16)return void e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Corrige los campos en rojo."});a.nombreCliente,a.apellidoCliente,a.telefonoCliente,a.emailCliente,a.fechaNacimiento,a.password;e.loading.show();const t=await d.api.post("Cliente/Agregar",{nombreCliente:a.nombreCliente,apellidoCliente:a.apellidoCliente,telefonoCliente:a.telefonoCliente,emailCliente:a.emailCliente,fechaNacimiento:a.fechaNacimiento,password:a.password}).catch((a=>{e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Ocurrió un problema. Intentálo de nuevo."})})).finally((()=>{e.loading.hide()}));201==t.status&&e.notify({color:"warning",textColor:"black",icon:"warning",message:"Ya existe un cuenta asociada al correo proporcionado."}),200==t.status&&(e.notify({color:"green-4",textColor:"white",icon:"check",message:"Cuenta creada exitosamente."}),setTimeout((()=>{n()}),2e3))}async function n(){const t=await d.api.post("Cliente/Login",{correo:a.emailCliente,password:a.password}).catch((a=>{e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Credenciales incorrectas."})})).finally((()=>{e.loading.hide()}));200==t.status&&(localStorage.setItem("clienteID",t.data.payload.clienteId),localStorage.setItem("emailCliente",t.data.payload.emailCliente),localStorage.setItem("nombreCliente",t.data.payload.nombreCliente),localStorage.setItem("apellidosCliente",t.data.payload.apellidoCliente),localStorage.setItem("telefonoCliente",t.data.payload.telefonoCliente),localStorage.setItem("token",t.data.payload.token),window.dispatchEvent(new CustomEvent("token-localstorage-changed",{detail:{storage:localStorage.getItem("token")}})),window.dispatchEvent(new CustomEvent("nombre-localstorage-changed",{detail:{storage:localStorage.getItem("nombreCliente")}})),location.replace("/"))}return(0,l.bv)((()=>{})),{state:a,onClean:t,onSubmit:o}}};var C=t(4260),g=t(4379),f=t(5269),h=t(4842),b=t(8240),w=t(7518),y=t.n(w);const v=(0,C.Z)(p,[["render",s],["__scopeId","data-v-3d2f12f4"]]),x=v;y()(p,"components",{QPage:g.Z,QForm:f.Z,QInput:h.Z,QBtn:b.Z})}}]);