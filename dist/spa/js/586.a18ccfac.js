"use strict";(self["webpackChunkmacodesgin"]=self["webpackChunkmacodesgin"]||[]).push([[586],{5586:(e,a,t)=>{t.r(a),t.d(a,{default:()=>U});var o=t(3673),l=t(2323);const r=e=>((0,o.dD)("data-v-579ff208"),e=e(),(0,o.Cn)(),e),s=r((()=>(0,o._)("div",{class:"tools q-pb-xl"},[(0,o._)("div",{class:"titulo"},"Gestión de pedidos")],-1))),n={class:"indicadores row q-pt-xl q-gutter-xl"},d={class:"text-h6"},i=(0,o.Uk)(" Pedidos procesados "),c={class:"text-h6"},m=(0,o.Uk)(" Pedidos fabricados "),p={class:"text-h6"},u=(0,o.Uk)(" Pedidos enviados "),g={class:"text-h6"},h=(0,o.Uk)(" Pedidos entregados "),w={class:"text-h6"},b=(0,o.Uk)(" ventas en el último mes "),f={class:"q-pt-xl"};function y(e,a,t,r,y,x){const v=(0,o.up)("q-card-section"),C=(0,o.up)("q-card"),_=(0,o.up)("TablaPedidos"),I=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(I,null,{default:(0,o.w5)((()=>[s,(0,o._)("div",n,[(0,o.Wm)(C,{flat:"",bordered:"",class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o._)("div",d,(0,l.zw)(e.state.procesados),1)])),_:1}),(0,o.Wm)(v,{class:"q-pt-none"},{default:(0,o.w5)((()=>[i])),_:1})])),_:1}),(0,o.Wm)(C,{flat:"",bordered:"",class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o._)("div",c,(0,l.zw)(e.state.fabricados),1)])),_:1}),(0,o.Wm)(v,{class:"q-pt-none"},{default:(0,o.w5)((()=>[m])),_:1})])),_:1}),(0,o.Wm)(C,{flat:"",bordered:"",class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o._)("div",p,(0,l.zw)(e.state.enviados),1)])),_:1}),(0,o.Wm)(v,{class:"q-pt-none"},{default:(0,o.w5)((()=>[u])),_:1})])),_:1}),(0,o.Wm)(C,{flat:"",bordered:"",class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o._)("div",g,(0,l.zw)(e.state.entregados),1)])),_:1}),(0,o.Wm)(v,{class:"q-pt-none"},{default:(0,o.w5)((()=>[h])),_:1})])),_:1}),(0,o.Wm)(C,{flat:"",bordered:"",class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o._)("div",w,(0,l.zw)(e.state.ventas),1)])),_:1}),(0,o.Wm)(v,{class:"q-pt-none"},{default:(0,o.w5)((()=>[b])),_:1})])),_:1})]),(0,o._)("div",f,[(0,o.Wm)(_)])])),_:1})}function x(e,a,t,l,r,s){const n=(0,o.up)("q-btn"),d=(0,o.up)("q-td"),i=(0,o.up)("q-icon"),c=(0,o.up)("q-input"),m=(0,o.up)("q-table");return(0,o.wg)(),(0,o.j4)(m,{title:"Pedidos","no-data-label":"Sin pedidos para mostrar","no-results-label":"No se encontaron pedidos basados en tu búsqueda",columns:l.state.columnas,rows:l.state.filas,"row-key":"ordenCompraID","rows-per-page-label":"Elementos por página","pagination-label":l.getPaginationLabel,pagination:l.state.pagination,loading:l.state.loading,filter:l.state.filter,dense:e.$q.screen.lt.md},{"body-cell-acciones":(0,o.w5)((e=>[(0,o.Wm)(d,{class:"q-gutter-sm",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{round:"",outline:"",dense:"",color:"amber",icon:"edit",onClick:a=>this.$router.push("/detalle_pedido/"+e.row.ordenCompraID)},null,8,["onClick"])])),_:2},1032,["props"])])),"top-right":(0,o.w5)((()=>[(0,o.Wm)(c,{borderless:"",dense:"",debounce:"300",modelValue:l.state.filter,"onUpdate:modelValue":a[0]||(a[0]=e=>l.state.filter=e),placeholder:"Buscar"},{append:(0,o.w5)((()=>[(0,o.Wm)(i,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["columns","rows","pagination-label","pagination","loading","filter","dense"])}var v=t(1959),C=t(5474),_=t(8825);const I={name:"TablaPedidos",setup(e,a){let t=[{value:0,label:"Procesada"},{value:1,label:"Fabricada"},{value:2,label:"Enviada"},{value:3,label:"Entregada"}];const l=(0,v.qj)({columnas:[{name:"ordenCompraID",label:"ID",align:"center",field:"ordenCompraID",sortable:!1,classes:"bg-grey-2 ellipsis",style:"max-width: 30px",headerClasses:"bg-primary text-white",headerStyle:"max-width: 30px"},{name:"nombreCliente",label:"Cliente",align:"center",field:"nombreCliente",sortable:!1,classes:"bg-grey-2 ellipsis",style:"max-width: 30px",headerClasses:"bg-primary text-white",headerStyle:"max-width: 30px"},{name:"fechaPedido",label:"F. de Pedido",align:"center",field:e=>n(e.fechaProcesada),sortable:!1,classes:"bg-grey-2 ellipsis",style:"max-width: 30px",headerClasses:"bg-primary text-white",headerStyle:"max-width: 30px"},{name:"estatus",label:"Estatus",align:"center",field:e=>t[e.procesada+e.fabricada+e.enviada+e.entregada-1].label,sortable:!1,classes:"bg-grey-2 ellipsis",style:"max-width: 30px",headerClasses:"bg-primary text-white",headerStyle:"max-width: 30px"},{name:"monto",label:"Monto",align:"center",field:e=>s(e.total),sortable:!1,classes:"bg-grey-2 ellipsis",style:"max-width: 30px",headerClasses:"bg-primary text-white",headerStyle:"max-width: 30px"},{name:"acciones",label:"Acciones",align:"center",field:"acciones",sortable:!1,classes:"bg-grey-2 ellipsis",style:"max-width: 30px",headerClasses:"bg-primary text-white",headerStyle:"max-width: 30px"}],filas:[],loading:!1,filter:"",pagination:{rowsPerPage:8}}),r=(0,_.Z)();function s(e){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(e)}function n(e){if(null==e)return null;let a=new Date(e),t=a.getDate(),o=a.getFullYear(),l=a.getMonth()+1;return t<10&&(t="0"+t),l<10&&(l="0"+l),t+"-"+l+"-"+o}function d(e,a,t){return e+"-"+a+" de "+t}function i(e){var t=e.row.ordenCompraID;a.emit("editarPedido",t)}function c(e){var a=e.row.pedidoID;r.dialog({title:"Eliminar pedido",message:"¿Deseas eliminar el pedido "+e.row.ordenCompraID+" del cliente "+e.row.nombreCliente+"?",ok:{push:!0,label:"Eliminar",color:"negative"},cancel:{label:"Cancelar",color:"primary",flat:!0},persistent:!0}).onOk((async()=>{const e=await C.api["delete"](`/Pedido/${a}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e&&200===e.status?r.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Pedido eliminado exitosamente"}):r.notify({color:"red-5",textColor:"white",icon:"warning",message:"Ocurrió un problema. Intentálo de nuevo."}),await C.api.get("OrdenCompra",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>l.filas=e.data.payload))}))}return(0,o.bv)((async()=>{await C.api.get("OrdenCompra",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>{l.filas=e.data.payload}))})),{state:l,editarPedido:i,eliminarPedido:c,getPaginationLabel:d,formatter:s}}};var P=t(4260),k=t(8107),q=t(3884),W=t(8240),S=t(4842),z=t(4554),D=t(7518),Z=t.n(D);const A=(0,P.Z)(I,[["render",x]]),B=A;Z()(I,"components",{QTable:k.Z,QTd:q.Z,QBtn:W.Z,QInput:S.Z,QIcon:z.Z});const O=(0,o.aZ)({name:"CatalogoPedidos",components:{TablaPedidos:B},setup(){document.title="Gestión de pedidos";const e=(0,v.qj)({procesados:0,fabricados:0,enviados:0,entregados:0,ventas:0}),a=setTimeout((()=>{window.location.reload(1)}),3e4);return(0,o.bv)((async()=>{await C.api.get("/OrdenCompra/IndicadorProcesados",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((a=>{e.procesados=a.data.payload.num})),await C.api.get("/OrdenCompra/IndicadorFabricados",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((a=>{e.fabricados=a.data.payload.num})),await C.api.get("/OrdenCompra/IndicadorEnviados",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((a=>{e.enviados=a.data.payload.num})),await C.api.get("/OrdenCompra/IndicadorEntregados",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((a=>{e.entregados=a.data.payload.num})),await C.api.get("/OrdenCompra/IndicadorVentasMes",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((a=>{e.ventas=a.data.payload.num}))})),(0,o.Ah)((async()=>{clearTimeout(a)})),{state:e}}});var E=t(4379),Q=t(151),T=t(5589);const F=(0,P.Z)(O,[["render",y],["__scopeId","data-v-579ff208"]]),U=F;Z()(O,"components",{QPage:E.Z,QCard:Q.Z,QCardSection:T.Z})}}]);